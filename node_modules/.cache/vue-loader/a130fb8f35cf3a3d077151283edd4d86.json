{"remainingRequest":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangluna/wln/vueSpace/vue-ergeng/src/views/index/comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/src/views/index/comment.vue","mtime":1561804039988},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from 'axios'\nimport headtitle from '../title.vue'\nimport { constants } from 'fs';\n\nimport toast from '@/components/toast'\n\nexport default {\n  name: \"comment\",\n  components:{\n    headtitle,\n    toast\n  },\n  data: function(){\n    return {\n       back:true,\n       title:'评论',\n       userInfo:'',\n       toastOptions:{},\n       param:{\n          videoId:'',\n          userId:'',\n          userNickName:'',\n          content:''\n       }\n    }\n  },\n  mounted(){\n    this.param.videoId = this.$route.query.id;\n    this.getUserInfo();\n  },\n  computed:{\n    wordNum:function(){\n        return this.param.content.length;\n    }\n  },\n  methods:{\n    getUserInfo(){\n        this.userInfo = JSON.parse(this.$store.state.userinfo);\n        this.param.userId = this.userInfo.userId,\n        this.param.userNickName = this.userInfo.userName\n    },\n\n    onSaveComment(){\n        if(this.param.content =='' || this.param.content.length>30){\n          this.showToast({\n            content: \"请输入评论内容\"\n          })\n          return;\n        }\n        console.log(this.param);\n        axios\n        .put('http://iot.smart-ideas.com.cn/ssgy/lnVideo/saveComments',{\n            userId: this.param.userId,\n            videoId: this.param.videoId,\n            userNickName: this.param.userNickName,\n            content: this.param.content\n        })\n        .then((res)=>{\n          console.log(res.data)\n            if(res.data.success){\n                this.param.content ='';\n                this.showToast({\n                    content:\"发布评论成功\",\n                    callback: ()=>{\n                      this.$router.go(-1);\n                    }\n                })\n            }\n        })\n        .catch((res)=>{\n            console.log(res);\n        })\n    },\n    showToast(obj){\n        this.$refs.toast.showTips();\n        this.toastOptions = obj;\n    }\n  }\n};\n",{"version":3,"sources":["comment.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"comment.vue","sourceRoot":"src/views/index","sourcesContent":["<template>\n  <div class=\"comment-page\">\n    <headtitle :back=\"back\" :title=\"title\"></headtitle>\n    <textarea class=\"comment-textarea\" name=\"\" id=\"\" v-model=\"param.content\" maxlength=\"30\"></textarea>\n    <div class=\"comment-count\">{{wordNum}} / 30</div>\n    <cube-button :primary=\"true\" @click=\"onSaveComment\">发布评论</cube-button>\n    <toast :toastOptions=\"toastOptions\" ref=\"toast\"></toast>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport headtitle from '../title.vue'\nimport { constants } from 'fs';\n\nimport toast from '@/components/toast'\n\nexport default {\n  name: \"comment\",\n  components:{\n    headtitle,\n    toast\n  },\n  data: function(){\n    return {\n       back:true,\n       title:'评论',\n       userInfo:'',\n       toastOptions:{},\n       param:{\n          videoId:'',\n          userId:'',\n          userNickName:'',\n          content:''\n       }\n    }\n  },\n  mounted(){\n    this.param.videoId = this.$route.query.id;\n    this.getUserInfo();\n  },\n  computed:{\n    wordNum:function(){\n        return this.param.content.length;\n    }\n  },\n  methods:{\n    getUserInfo(){\n        this.userInfo = JSON.parse(this.$store.state.userinfo);\n        this.param.userId = this.userInfo.userId,\n        this.param.userNickName = this.userInfo.userName\n    },\n\n    onSaveComment(){\n        if(this.param.content =='' || this.param.content.length>30){\n          this.showToast({\n            content: \"请输入评论内容\"\n          })\n          return;\n        }\n        console.log(this.param);\n        axios\n        .put('http://iot.smart-ideas.com.cn/ssgy/lnVideo/saveComments',{\n            userId: this.param.userId,\n            videoId: this.param.videoId,\n            userNickName: this.param.userNickName,\n            content: this.param.content\n        })\n        .then((res)=>{\n          console.log(res.data)\n            if(res.data.success){\n                this.param.content ='';\n                this.showToast({\n                    content:\"发布评论成功\",\n                    callback: ()=>{\n                      this.$router.go(-1);\n                    }\n                })\n            }\n        })\n        .catch((res)=>{\n            console.log(res);\n        })\n    },\n    showToast(obj){\n        this.$refs.toast.showTips();\n        this.toastOptions = obj;\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n.comment-page {\n    padding: 50px 15px 0;\n    .comment-textarea{\n        width:100%;\n        height: 100px;\n        line-height: 20px;\n        padding:5px 15px;\n        border:1px solid #ccc;\n        box-sizing:border-box;\n        margin-bottom: 5px;\n    }\n    .comment-count{\n      text-align: right;\n      margin-bottom: 10px;\n    }\n    \n}\n</style>\n"]}]}
{"remainingRequest":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangluna/wln/vueSpace/vue-ergeng/src/views/index/detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/src/views/index/detail.vue","mtime":1561987432624},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/vue-ergeng/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport imgUrl from '@/assets/images/collect-icon-on.png'\nimport imgUrlOff from '@/assets/images/collect-icon-off.png'\n\nimport Axios from 'axios'\nimport BScroll from 'better-scroll'\nimport headtitle from '../title.vue'\nimport toast from '@/components/toast'\nimport { constants } from 'fs';\nimport * as apiUrl from \"@/common/apiUrl.js\";\n\nexport default {\n  name: \"indexdetail\",\n  components:{\n    headtitle,\n    toast\n  },\n  data: function(){\n      return {\n        headtitle:\"详情\",\n        back: true,\n        detailInfo:'',\n        reviewList: [],\n        _dom: '',\n        controls: false,\n        isPlay: false,\n        isCollect: false,\n        imgUrl,\n        imgUrlOff, \n        params:{\n            videoId:'',\n            userId:''\n        },\n        toastOptions:{}\n      }\n  },\n  created(){\n    this.params.videoId = this.$route.query.id;\n    this.params.userId = this.$store.state.userinfo ? JSON.parse(this.$store.state.userinfo).userId : 'noLogin';\n  },\n  mounted() {\n    this.getVideoDetail();\n    this.getReview();\n    this.$nextTick(() => {\n        this.scroll = new BScroll(this.$refs.wrapper, {\n            bounce: {\n                top: true,\n                bottom: true,\n                left: false,\n                right: false\n            }\n        })\n    })\n    \n  },\n  methods: {\n    getVideoDetail:function(){\n        Axios\n        .get(apiUrl.api_test_url +'lnVideo/findById/'+this.params.videoId+'/'+ this.params.userId)\n        .then((res)=>{\n            var data = res.data;\n            if(data.success){\n                this.detailInfo = data.video;\n                if(data.video.isCollecttion === 'Y'){\n                    this.isCollect = true;\n                }\n            }\n        })\n    },\n    getReview:function(){\n        Axios\n        .get(apiUrl.api_test_url+'lnVideo/findCommentsByVideoId/'+this.params.videoId)\n        .then((res)=>{\n            var data = res.data;\n            if(data.success){\n                this.reviewList = data.comments;\n            }\n        })\n    },\n    videoPlay:function(){\n        this._dom = document.getElementById('detailVideo');\n        this.isPlay = !this.isPlay;\n        this.controls = true;\n        this._dom.play();\n    },\n    flagFavorite(){\n        if(this.params.userId ==='noLogin'){\n            this.showToast({\n                content:\"您还没有登录，去登录~\",\n                callback: ()=>{\n                    this.$router.push({name: 'login'})\n                }\n            });\n            return;\n        }\n        if(this.isCollect){\n            Axios\n            .delete(apiUrl.api_test_url+'lnVideo/deleteUserVideo/'+ this.params.userId +'/'+ this.params.videoId)\n            .then((res)=>{\n                var data = res.data;\n                if(data.success){\n                    this.isCollect = false;\n                    this.showToast({\n                        content:\"以取消收藏\"\n                    });\n                }\n            })\n        }else{\n            Axios\n            .put(apiUrl.api_test_url+'lnVideo/saveUserVideo',{\n                userId: this.params.userId,\n                videoId: this.params.videoId\n            })\n            .then((res)=>{\n                var data = res.data;\n                if(data.success){\n                    this.isCollect = true;\n                    this.showToast({\n                        content:\"收藏成功\"\n                    });\n                }\n            })\n        }\n    },\n    onComment(){\n        if(this.params.userId === 'noLogin'){\n            this.showToast({\n                content:\"您还没有登录，去登录~\",\n                callback: ()=>{\n                    this.$router.push({name: 'login',query:{'backComponentName':'indexdetail','id': this.params.videoId}})\n                }\n            });\n        }else{\n            this.$router.push({path: '/comment', query:{'id': this.params.videoId}})\n        }\n        \n    },\n    showToast(obj){\n        this.$refs.toast.showTips();\n        this.toastOptions = obj;\n    },\n  }\n};\n",null]}
{"remainingRequest":"/Users/wangluna/wln/vueSpace/video-geng/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/wangluna/wln/vueSpace/video-geng/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangluna/wln/vueSpace/video-geng/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangluna/wln/vueSpace/video-geng/src/views/index/search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangluna/wln/vueSpace/video-geng/src/views/index/search.vue","mtime":1561992892670},{"path":"/Users/wangluna/wln/vueSpace/video-geng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/video-geng/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/video-geng/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangluna/wln/vueSpace/video-geng/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nimport { constants } from 'fs';\nimport myDialog from '@/components/confirm.vue';\nimport * as apiUrl from \"@/common/apiUrl.js\";\nexport default {\n  name: \"search\",\n  components: {\n    // headtitle\n    myDialog: myDialog\n  },\n  data: function data() {\n    return {\n      placeholder: '搜索视频',\n      query: '',\n      queryResult: [],\n      hasResult: false,\n      page: 1,\n      size: 2,\n      seaHis: [],\n      userInfo: {},\n      confirmOptions: {}\n    };\n  },\n  watch: {\n    query: function query() {\n      var _this = this;\n\n      if (this.query == '') {\n        this.hasResult = false;\n        this.queryResult = [];\n        return;\n      }\n\n      axios.get(apiUrl.api_test_url + 'lnVideo/list/' + this.page + '/' + this.size, {\n        params: {\n          videoName: this.query\n        }\n      }).then(function (res) {\n        _this.queryResult = [];\n        var data = res.data;\n        _this.hasResult = true;\n        var list = data.queryResult.list;\n        var resList = _this.queryResult;\n\n        for (var key in list) {\n          resList.push(list[key]);\n        }\n\n        _this.queryResult = resList;\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  },\n  mounted: function mounted() {\n    if (this.$store.state.userinfo) {\n      this.userInfo.userId = JSON.parse(this.$store.state.userinfo).userId;\n      this.initHistory(this.userInfo.userId);\n    } else {\n      this.initHistory('tourists');\n    }\n  },\n  methods: {\n    initHistory: function initHistory(userId) {\n      var seaHis = window.sessionStorage.getItem('seaHis') ? JSON.parse(window.sessionStorage.getItem('seaHis')) : '';\n\n      if (seaHis == '' || seaHis == 'undefined') {\n        return;\n      } else {\n        this.showHistory(userId);\n      }\n    },\n    toDetail: function toDetail(videoId) {\n      var obj = {};\n\n      if (this.userInfo.userId) {\n        //userId存在，说明用户已登录\n        obj = {\n          userId: this.userInfo.userId,\n          name: this.query\n        };\n      } else {\n        //userId不存在，说明用户是游客状态\n        obj = {\n          userId: 'tourists',\n          name: this.query\n        };\n      } //点击搜索结果时判断是否存储搜索记录\n\n\n      var seaHis = JSON.parse(window.sessionStorage.getItem('seaHis')) || ''; //定义是否存储状态 true：存储 \n\n      var isStorage = true;\n      var arr = [];\n\n      for (var key in seaHis) {\n        //搜索记录相同时 存储状态改为false\n        if (seaHis[key].name == obj.name) {\n          isStorage = false;\n          break;\n        }\n\n        arr.push(seaHis[key]);\n      } //根据存储状态来判断是否存储\n\n\n      if (isStorage) {\n        arr.unshift(obj);\n        window.sessionStorage.setItem('seaHis', JSON.stringify(arr));\n      }\n\n      this.$router.push({\n        path: '/detail',\n        query: {\n          id: videoId\n        }\n      });\n    },\n    showHistory: function showHistory(userId) {\n      // console.log('showHistory  id= ' + userId)\n      var searchHistory = JSON.parse(window.sessionStorage.getItem('seaHis'));\n      var arr = [];\n\n      for (var key in searchHistory) {\n        if (searchHistory[key].userId === userId) {\n          arr.push(searchHistory[key]);\n        }\n      }\n\n      this.seaHis = arr;\n    },\n    historyHandler: function historyHandler(name) {\n      this.query = name;\n    },\n    delHistory: function delHistory() {\n      var _this2 = this;\n\n      this.$refs.myConfirm.showModel();\n      this.confirmOptions = {\n        type: \"warning\",\n        //warning\n        message: \"是否删除搜索历史？\",\n        //\"\"\n        btnSubmitFunction: function btnSubmitFunction() {\n          window.sessionStorage.removeItem('seaHis');\n\n          _this2.showHistory();\n        },\n        btnCancelFunction: function btnCancelFunction() {}\n      };\n    },\n    onCancle: function onCancle() {\n      this.$router.go(-1);\n    }\n  }\n};",{"version":3,"sources":["search.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"search-page\">\n        <div class=\"search-box\">\n            <input class=\"search-input\" :placeholder=\"placeholder\" v-model.trim=\"query\" type=\"text\">\n            <span class=\"search-cancle\" @click=\"onCancle()\">取消</span>\n        </div>\n        <!-- 热门搜索 -->\n        <ul class=\"hot-list\"  v-show=\"!hasResult\">\n            <div>热门搜索</div>\n            <ul>    \n                <li class=\"hot-item\"><span>美食</span></li>\n                <li class=\"hot-item\"><span>地铁枢纽</span></li>\n            </ul>\n        </ul>\n        <!--搜索历史 -->\n        <div v-if=\"seaHis.length>0\">\n            <ul class=\"hot-list\"  v-show=\"!hasResult\">\n                <div>搜索历史 <img class=\"del\" src=\"@/assets/images/del.png\" @click=\"delHistory()\" alt=\"\"> </div>\n                <ul>   \n                    <li class=\"hot-item\" v-for=\"(item,index) in seaHis\" :key=\"index\" @click=\"historyHandler(item.name)\">\n                        <span>{{item.name}}</span>    \n                    </li> \n                </ul>\n            </ul>\n        </div>\n        <!-- 搜索结果 -->\n        <ul class=\"result-list\" v-show=\"hasResult\">\n            <li  class=\"result-item\" v-for=\"(item) in queryResult\" :key=\"item.id\" @click=\"toDetail(item.id)\">\n                {{item.videoName}}\n            </li>\n            <li class=\"noResult\" v-show=\"!queryResult.length\">未找到搜索结果</li>\n        </ul>\n        <my-dialog v-bind:confirmModalOptions=\"confirmOptions\" ref=\"myConfirm\"></my-dialog>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { constants } from 'fs';\nimport myDialog from '@/components/confirm.vue'\nimport * as apiUrl from \"@/common/apiUrl.js\";\n\nexport default {\n  name: \"search\",\n  components:{\n    // headtitle\n    myDialog\n  },\n  data: function(){\n      return {\n        placeholder:'搜索视频',\n        query:'',\n        queryResult: [],\n        hasResult: false,\n        page:1,\n        size:2,\n        seaHis:[],\n        userInfo:{},\n        confirmOptions:{\n\n        }\n      }\n  },\n  watch:{\n    query(){\n        if(this.query == ''){\n            this.hasResult = false;\n            this.queryResult =[];\n            return;\n        }\n        axios\n        .get(apiUrl.api_test_url+'lnVideo/list/'+this.page+'/'+this.size,{\n            params: {\n                videoName: this.query\n            }\n        })\n        .then((res)=>{\n            this.queryResult =[];\n            var data = res.data;\n            this.hasResult = true;\n            var list = data.queryResult.list;\n            var resList = this.queryResult;\n            for(var key in list){\n                resList.push(list[key]);\n            }\n            this.queryResult = resList;\n        })\n        .catch((err) => {\n            console.log(err)\n        })\n    }\n  },\n  mounted(){\n      if(this.$store.state.userinfo){\n        this.userInfo.userId = JSON.parse(this.$store.state.userinfo).userId;\n        this.initHistory(this.userInfo.userId);\n      }else{\n        this.initHistory('tourists');\n      }\n  },\n  methods:{\n    initHistory(userId){\n        var seaHis = window.sessionStorage.getItem('seaHis') ? JSON.parse(window.sessionStorage.getItem('seaHis')) : '';\n        if(seaHis == '' || seaHis == 'undefined'){\n            return;\n        }else{\n            this.showHistory(userId);\n        }\n    },\n    toDetail(videoId){\n        var obj ={}\n        if(this.userInfo.userId){//userId存在，说明用户已登录\n            obj = {userId: this.userInfo.userId, name: this.query};\n        }else{//userId不存在，说明用户是游客状态\n            obj ={userId: 'tourists', name: this.query}\n        }\n        //点击搜索结果时判断是否存储搜索记录\n        var seaHis = JSON.parse(window.sessionStorage.getItem('seaHis')) || '';\n        //定义是否存储状态 true：存储 \n        var isStorage = true;\n        var arr = [];\n        \n        for(var key in seaHis){\n            //搜索记录相同时 存储状态改为false\n            if(seaHis[key].name == obj.name){\n                isStorage = false;\n                break;\n            }\n            arr.push(seaHis[key])\n        }\n        //根据存储状态来判断是否存储\n        if(isStorage){\n            arr.unshift(obj);\n            window.sessionStorage.setItem('seaHis',JSON.stringify(arr));\n        }\n        this.$router.push({path:'/detail', query: {id: videoId}})\n\n    },\n    showHistory(userId){\n        // console.log('showHistory  id= ' + userId)\n        var searchHistory = JSON.parse(window.sessionStorage.getItem('seaHis'));\n        var arr = [];\n        for(var key in searchHistory){\n            if(searchHistory[key].userId === userId){\n                arr.push(searchHistory[key])\n            }\n        }\n        this.seaHis = arr;\n\n    },\n    historyHandler(name){\n        this.query = name;\n    },\n    delHistory(){\n        this.$refs.myConfirm.showModel();\n        this.confirmOptions= {\n            type: \"warning\",//warning\n            message: \"是否删除搜索历史？\",//\"\"\n            btnSubmitFunction: ()=> {\n               window.sessionStorage.removeItem('seaHis');\n               this.showHistory();\n            },\n            btnCancelFunction: function () {\n                \n            }\n        }\n        \n        \n    },\n    onCancle(){\n        this.$router.go(-1);\n    }\n\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n   .search-page{\n       padding:10px 15px 0;\n       .search-box{\n           background: #f1f3f5;\n           padding: 5px;\n           display: flex;\n           .search-input{\n               height: 30px;\n               line-height: 30px;\n               display: block;\n               padding-left: 50px;\n               flex: 1;\n               background:#fff url(http://www.ruyutrip.com/img/mb_v2/list_icon.png)no-repeat 10px center;\n               background-size: 15px 15px;\n               &:focus{\n                   outline: none\n               }\n           }\n           .search-cancle{\n               height: 30px;\n               line-height: 30px;\n               width:80px;\n               text-align: center;\n               color:#333;\n           }\n       }\n       .hot-list{\n           overflow: hidden;\n           padding-top: 30px;\n           div{\n               font-size: 16px;\n               padding-bottom: 20px;\n               .del{\n                   width:16px;\n                   height:16px;\n                   float: right;\n                   margin-top:5px;\n               }\n           }\n           .hot-item{\n               display:inline-block;\n               line-height: 22px;\n               padding:3px 10px;\n               background: #eee;\n               margin-right: 15px;\n               color:#999;\n               border-radius: 4px;\n               margin-bottom: 5px;\n           }\n       }\n       .result-list{\n           .result-item{\n               height: 46px;\n               line-height: 46px;\n               border-bottom: 1px solid #eee;\n               overflow: hidden;\n                text-overflow:ellipsis;\n                white-space: nowrap;\n           }\n           .noResult{ \n               text-align: center;\n               padding: 30px 15px;\n           }\n       }\n   }\n</style>\n"],"sourceRoot":"src/views/index"}]}